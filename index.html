
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <title>Nova AI Mobile</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <link crossorigin="" href="https://fonts.gstatic.com/" rel="preconnect"/>
  <link as="style" href="https://fonts.googleapis.com/css2?display=swap&amp;family=Noto+Sans%3Awght%40400%3B500%3B700%3B900&amp;family=Space+Grotesk%3Awght%40400%3B500%3B700" onload="this.rel='stylesheet'" rel="stylesheet"/>
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"/>
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" rel="stylesheet"/>
  <link href="data:image/x-icon;base64," rel="icon" type="image/x-icon"/>
  <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
  <link rel="stylesheet" href="index.css">
  <style>
    body {
      min-height: 100dvh; 
      overscroll-behavior-y: contain;
      font-family: "Space Grotesk", "Noto Sans", sans-serif;
      margin: 0; 
    }
    .app-screen {
      display: none; 
      width: 100%;
      height: 100dvh; 
      overflow-x: hidden; 
    }
    .app-screen.active {
      display: flex; 
      flex-direction: column;
    }
    .scrollbar-hide::-webkit-scrollbar { display: none; }
    .scrollbar-hide { -ms-overflow-style: none; scrollbar-width: none; }
    .pb-safe-bottom { padding-bottom: env(safe-area-inset-bottom); }
    .material-symbols-outlined.filled { font-variation-settings: 'FILL' 1 }

    @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.7; } }
    .animate-pulse-glow { animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite; }
    @keyframes progressBar { 0% { width: 0%; } 100% { width: 100%; } }
    .animate-progress { animation: progressBar 3s ease-out forwards; }
    .neon-glow { box-shadow: 0 0 5px #19e5c6, 0 0 10px #19e5c6, 0 0 15px #19e5c6, 0 0 20px #19e5c6; }

    .mic-listening-indicator {
        display: none;
        width: 8px;
        height: 8px;
        background-color: red;
        border-radius: 50%;
        position: absolute;
        top: 5px;
        right: 5px;
    }
    .mic-button-container.listening .mic-listening-indicator {
        display: block;
    }
    .mic-button-container.listening svg {
        color: #ff4d4d; 
    }
    #voice-mode-toggle.active svg {
      color: #19e5c6; 
    }
    #nova-processing-indicator {
        transition: opacity 0.3s ease-in-out;
    }
  </style>
</head>
<body class="bg-[#0A100F]">
  <div class="lg:flex">
    <!-- Desktop Sidebar Navigation -->
    <nav id="desktop-sidebar" class="flex flex-col w-60 xl:w-64 bg-[#0D1A18] border-r border-[#1B302C] h-screen fixed top-0 left-0 z-40 p-4 space-y-2 overflow-y-auto scrollbar-hide transition-all duration-300 ease-in-out hidden lg:flex">
        <div class="flex items-center justify-between mb-6">
            <div class="text-2xl font-bold text-white p-2 flex items-center gap-3 sidebar-logo-text">
                <svg class="w-8 h-8 text-[#19e5c6]" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 2L2 7L12 12L22 7L12 2Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"></path><path d="M2 17L12 22L22 17" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"></path><path d="M2 12L12 17L22 12" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"></path><circle class="opacity-75" cx="12" cy="12" fill="#19e5c6" r="3"></circle></svg>
                <span class="sidebar-text">Nova</span>
            </div>
            <button id="toggle-sidebar-btn" aria-label="Toggle sidebar" class="p-2 text-[#7A9A94] hover:text-[#19E5C6] lg:block hidden">
                <span class="material-symbols-outlined">menu_open</span>
            </button>
        </div>
        <button data-target="chat-list-screen-home" class="sidebar-nav-item flex items-center gap-3 p-3 rounded-lg text-[#7A9A94] hover:bg-[#1B302C] hover:text-[#19E5C6] transition-colors w-full text-left">
            <span class="material-symbols-outlined">home</span>
            <span class="sidebar-text text-sm font-medium nav-text-home">Home</span>
        </button>
        <button data-target="image-studio-screen" class="sidebar-nav-item flex items-center gap-3 p-3 rounded-lg text-[#7A9A94] hover:bg-[#1B302C] hover:text-[#19E5C6] transition-colors w-full text-left">
            <span class="material-symbols-outlined">imagesmode</span>
            <span class="sidebar-text text-sm font-medium nav-text-image-studio">Image Studio</span>
        </button>
        <button data-target="chat-screen" id="sidebar-new-chat-nav-btn" class="sidebar-nav-item flex items-center gap-3 p-3 rounded-lg text-[#7A9A94] hover:bg-[#1B302C] hover:text-[#19E5C6] transition-colors w-full text-left">
            <span class="material-symbols-outlined">add_comment</span>
            <span class="sidebar-text text-sm font-medium nav-text-new-chat">New Chat</span>
        </button>
         <button data-target="create-tool-screen" id="sidebar-create-tool-nav-btn" class="sidebar-nav-item flex items-center gap-3 p-3 rounded-lg text-[#7A9A94] hover:bg-[#1B302C] hover:text-[#19E5C6] transition-colors w-full text-left">
            <span class="material-symbols-outlined">construction</span>
            <span class="sidebar-text text-sm font-medium">Create Tool</span>
        </button>
        <button data-target="profile-screen" class="sidebar-nav-item flex items-center gap-3 p-3 rounded-lg text-[#7A9A94] hover:bg-[#1B302C] hover:text-[#19E5C6] transition-colors w-full text-left">
            <span class="material-symbols-outlined">person</span>
            <span class="sidebar-text text-sm font-medium nav-text-profile">Profile</span>
        </button>
        <div class="flex-grow"></div> <!-- Spacer -->
        <button data-target="settings-screen" class="sidebar-nav-item flex items-center gap-3 p-3 rounded-lg text-[#7A9A94] hover:bg-[#1B302C] hover:text-[#19E5C6] transition-colors w-full text-left">
            <span class="material-symbols-outlined">settings</span>
            <span class="sidebar-text text-sm font-medium nav-text-settings">Settings</span>
        </button>
    </nav>

    <!-- Main Content Area for all screens -->
    <main id="app-main-content" class="w-full lg:ml-60 xl:ml-64 transition-all duration-300 ease-in-out">
      <!-- Splash Screen -->
      <div id="splash-screen" class="app-screen active bg-[#0A100F] justify-center items-center">
        <div class="relative flex size-full flex-col justify-center items-center group/design-root overflow-hidden">
          <div class="absolute inset-0 bg-grid-[#19e5c6]/5 opacity-10 pointer-events-none"></div>
          <div class="flex flex-col items-center justify-center h-full w-full px-8">
            <div class="w-32 h-32 mb-8 relative flex items-center justify-center">
              <div class="absolute inset-0 rounded-full bg-[#19e5c6] opacity-30 animate-pulse-glow blur-2xl"></div>
              <svg class="w-24 h-24 text-[#19e5c6] z-10 animate-pulse-glow" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M12 2L2 7L12 12L22 7L12 2Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"></path>
                <path d="M2 17L12 22L22 17" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"></path>
                <path d="M2 12L12 17L22 12" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"></path>
                <circle class="opacity-75" cx="12" cy="12" fill="#19e5c6" r="3"></circle>
              </svg>
            </div>
            <h1 class="text-5xl font-bold text-white mb-2 tracking-tighter animate-pulse-glow">Nova</h1>
            <p class="text-sm font-normal text-[#93c8c0] mb-12">Your Futuristic AI Assistant</p>
            <div class="w-full max-w-xs">
              <div class="rounded-full bg-[#1E3A35] h-2.5 overflow-hidden neon-glow opacity-75">
                <div id="splash-progress-bar" class="h-full rounded-full bg-[#19e5c6] animate-progress" style="width: 0%;"></div>
              </div>
              <p class="text-center text-xs text-[#19e5c6] mt-2 opacity-75">Initializing...</p>
            </div>
          </div>
          <div class="absolute bottom-0 left-0 right-0 p-4 text-center">
            <p class="text-xs text-[#4A5C5A]" id="splash-version-text">Version 2.0.0</p> 
          </div>
        </div>
      </div>

      <!-- Onboarding Screen -->
      <div id="onboarding-screen" class="app-screen bg-[#11221f] justify-between">
        <div class="flex flex-col flex-grow">
          <div class="flex items-center p-4 pb-2 justify-center">
            <h2 id="onboarding-title" class="text-white text-xl lg:text-2xl font-bold leading-tight tracking-[-0.015em]">AI Assistant</h2>
          </div>
          <div class="flex-grow flex flex-col justify-center">
            <div class="@container">
              <div class="@[480px]:px-4 @[480px]:py-3">
                <div id="onboarding-image" class="w-full bg-center bg-no-repeat bg-cover flex flex-col justify-end overflow-hidden @[480px]:rounded-xl min-h-[30vh] sm:min-h-[40vh] aspect-square mx-auto max-w-md lg:max-w-lg" style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuDISnZDku6mxFufrdwyE8U_z3gRZvZUH6Sr7mxWY8opjTDKQYYYW4ButLoD-XUfyYe42PyqETKsHsJlrKL83tNQdCJE60dHYZf_WPlpQtZpJ0Zn1HKjhKBHrxuB0mY7ZlveDIl1oKPhbQT5GoxP-abVe_hkaPNsjY4FF-30GfB-wG9C456BvxyI7s1yE0A7J4CFCSN7SQhHazA_I8NTgQryctLNxst4uLDyUV-ZGE9ol4U8MzmCVKUkH5WsMdau8gpXcxZYvPD9Wj0");'></div>
              </div>
            </div>
            <div class="px-6 pt-6 pb-4 text-center">
              <h id="onboarding-main-text" class="text-white text-3xl lg:text-4xl font-bold leading-tight tracking-tight">Your Personal AI Companion</h>
              <p id="onboarding-sub-text" class="text-gray-300 text-lg lg:text-xl font-normal leading-relaxed pt-3 max-w-2xl mx-auto">
                Unlock the power of AI with our advanced chatbot. Get instant answers, creative inspiration, and personalized assistance anytime, anywhere.
              </p>
            </div>
          </div>
          <div id="onboarding-dots" class="flex w-full flex-row items-center justify-center gap-2.5 py-5">
            <div class="onboarding-dot h-2.5 w-2.5 rounded-full bg-[#19e5c6]"></div>
            <div class="onboarding-dot h-2.5 w-2.5 rounded-full bg-[#34655e]"></div>
            <div class="onboarding-dot h-2.5 w-2.5 rounded-full bg-[#34655e]"></div>
          </div>
        </div>
        <div class="px-6 pb-8 pt-4 lg:max-w-md lg:mx-auto lg:w-full">
          <div class="flex flex-col sm:flex-row gap-4 justify-between">
            <button id="onboarding-next-btn" class="flex flex-1 min-w-[84px] cursor-pointer items-center justify-center overflow-hidden rounded-full h-14 px-6 bg-[#19e5c6] text-[#11221f] text-lg font-bold leading-normal tracking-wide hover:bg-opacity-90 transition-colors duration-200">
              <span class="truncate">Next</span>
            </button>
            <button id="onboarding-skip-btn" class="flex flex-1 min-w-[84px] cursor-pointer items-center justify-center overflow-hidden rounded-full h-14 px-6 bg-[#244742] text-white text-lg font-bold leading-normal tracking-wide hover:bg-opacity-80 transition-colors duration-200">
              <span class="truncate">Skip</span>
            </button>
          </div>
          <div class="h-5"></div> 
        </div>
      </div>

      <!-- Sign In / Sign Up Screen -->
      <div id="signin-screen" class="app-screen bg-[#11221f] justify-center lg:justify-between">
        <div class="flex flex-col items-center px-6 pt-10 lg:pt-16 overflow-y-auto w-full">
          <div class="text-center mb-10">
            <h1 class="text-4xl lg:text-5xl font-bold text-white tracking-tight" id="signin-welcome-title">Welcome</h1>
            <p class="text-sm lg:text-base text-[#93c8c0] mt-2" id="signin-prompt-text">Sign in or create an account to continue.</p>
          </div>
          <div class="w-full max-w-md space-y-6">
            <div class="relative">
              <span class="material-icons absolute left-3 top-1/2 -translate-y-1/2 text-[#93c8c0]">email</span>
              <input id="signin-email-input" class="form-input w-full rounded-xl border-none bg-[#244742] h-14 pl-12 pr-4 text-white placeholder:text-[#93c8c0] focus:ring-2 focus:ring-[#19e5c6] transition-all duration-300" placeholder="Email" type="email" autocomplete="email"/>
            </div>
            <div class="relative">
              <span class="material-icons absolute left-3 top-1/2 -translate-y-1/2 text-[#93c8c0]">lock</span>
              <input id="signin-password-input" class="form-input w-full rounded-xl border-none bg-[#244742] h-14 pl-12 pr-4 text-white placeholder:text-[#93c8c0] focus:ring-2 focus:ring-[#19e5c6] transition-all duration-300" placeholder="Password" type="password" autocomplete="current-password"/>
            </div>
            <p id="auth-error-message" class="text-sm text-red-400 text-center" style="display: none;"></p>
            <div class="flex flex-col sm:flex-row gap-4">
                <button id="signin-button" class="flex-1 w-full rounded-full bg-[#19e5c6] h-14 text-[#11221f] text-lg font-bold tracking-wider hover:bg-opacity-90 transition-all duration-300 shadow-lg shadow-[#19e5c6]/30">
                Sign In
                </button>
                <button id="signup-button" class="flex-1 w-full rounded-full bg-[#244742] h-14 text-white text-lg font-bold tracking-wider hover:bg-[#2f5a54] transition-all duration-300">
                Sign Up
                </button>
            </div>
          </div>
        </div>
         <div class="pb-8 pt-12 text-center shrink-0">
            <p class="text-xs text-[#7A9A94]" id="signin-poweredby-text">Powered by Firebase Authentication</p>
        </div>
      </div>
      
      <!-- Chat List Screen -->
      <div id="chat-list-screen" class="app-screen bg-[#0D1A18] justify-between">
        <div class="flex-grow flex flex-col overflow-hidden">
          <header class="sticky top-0 z-10 bg-[#0D1A18]/80 backdrop-blur-md shrink-0">
            <div class="flex items-center p-4 pb-3 justify-between">
              <button id="chat-list-create-tool-btn" aria-label="Create New Tool" class="flex items-center justify-center rounded-full h-10 w-10 text-white hover:bg-[#19E5C6]/10 active:bg-[#19E5C6]/20 transition-colors lg:hidden">
                <span class="material-symbols-outlined">construction</span>
              </button>
              <h1 class="text-xl lg:text-2xl font-bold text-white tracking-tight flex-1 text-center lg:text-left lg:pl-2" id="chat-list-title">Chats & Tools</h1>
              <button id="chat-list-new-chat-header-btn" aria-label="New Chat" class="flex items-center justify-center rounded-full h-10 w-10 text-white hover:bg-[#19E5C6]/10 active:bg-[#19E5C6]/20 transition-colors lg:hidden">
                <svg fill="currentColor" height="24px" viewBox="0 0 256 256" width="24px" xmlns="http://www.w3.org/2000/svg">
                  <path d="M224,128a8,8,0,0,1-8,8H136v80a8,8,0,0,1-16,0V136H40a8,8,0,0,1,0-16h80V40a8,8,0,0,1,16,0v80h80A8,8,0,0,1,224,128Z"></path>
                </svg>
              </button>
            </div>
            <div class="px-4 pb-3 pt-1">
              <div class="relative">
                <div class="pointer-events-none absolute inset-y-0 left-0 flex items-center pl-4">
                  <svg class="text-[#7A9A94]" fill="currentColor" height="20px" viewBox="0 0 256 256" width="20px" xmlns="http://www.w3.org/2000/svg">
                    <path d="M229.66,218.34l-50.07-50.06a88.11,88.11,0,1,0-11.31,11.31l50.06,50.07a8,8,0,0,0,11.32-11.32ZM40,112a72,72,0,1,1,72,72A72.08,72.08,0,0,1,40,112Z"></path>
                  </svg>
                </div>
                <input id="search-chats-tools-input" class="form-input block w-full rounded-xl border-none bg-[#1B302C] py-3 pl-11 pr-4 text-base text-white placeholder:text-[#7A9A94] focus:outline-none focus:ring-2 focus:ring-[#19E5C6] focus:ring-offset-2 focus:ring-offset-[#0D1A18] transition-shadow" placeholder="Search chats & tools..." value=""/>
              </div>
            </div>
          </header>
          <main id="chat-list-items-container" class="flex-grow divide-y divide-[#1B302C] overflow-y-auto">
            <!-- Chat items and Tool Cards will be rendered here by JS -->
          </main>
        </div>
        <nav class="bottom-nav sticky bottom-0 bg-[#0D1A18]/80 backdrop-blur-md border-t border-[#1B302C] shrink-0 lg:hidden">
          <div class="flex justify-around items-center px-2 pt-2 pb-safe-bottom">
            <button data-target="chat-list-screen-home" class="nav-item active flex flex-col items-center justify-end gap-0.5 text-[#19E5C6] hover:text-opacity-80 transition-colors w-1/4 py-1">
                <span class="material-symbols-outlined filled">home</span>
                <span class="text-xs font-medium nav-text-home">Home</span>
            </button>
            <button data-target="image-studio-screen" class="nav-item flex flex-col items-center justify-end gap-0.5 text-[#7A9A94] hover:text-[#19E5C6] transition-colors w-1/4 py-1">
              <span class="material-symbols-outlined">imagesmode</span>
              <span class="text-xs nav-text-image-studio">Image Studio</span>
            </button>
            <button data-target="chat-screen" id="chat-list-new-chat-nav-btn" class="nav-item flex flex-col items-center justify-end gap-0.5 text-[#7A9A94] hover:text-[#19E5C6] transition-colors w-1/4 py-1">
              <svg fill="currentColor" height="26px" viewBox="0 0 256 256" width="26px" xmlns="http://www.w3.org/2000/svg">
                <path d="M128,32a96,96,0,1,0,96,96A96.11,96.11,0,0,0,128,32Zm0,176a80,80,0,1,1,80-80A80.09,80.09,0,0,1,128,208Zm40-88a8,8,0,0,1-8,8H136v24a8,8,0,0,1-16,0V128H96a8,8,0,0,1,0-16h24V88a8,8,0,0,1,16,0v24h24A8,8,0,0,1,168,120Z" fill-rule="evenodd"></path>
              </svg>
              <span class="text-xs nav-text-new-chat">New Chat</span>
            </button>
            <button data-target="profile-screen" class="nav-item flex flex-col items-center justify-end gap-0.5 text-[#7A9A94] hover:text-[#19E5C6] transition-colors w-1/4 py-1">
               <span class="material-symbols-outlined">person</span>
              <span class="text-xs nav-text-profile">Profile</span>
            </button>
          </div>
          <div class="h-[calc(env(safe-area-inset-bottom)/2)]"></div>
        </nav>
      </div>

      <!-- Chat Screen -->
      <div id="chat-screen" class="app-screen bg-[#0C1A18] justify-between">
        <div class="flex-grow overflow-hidden flex flex-col">
            <div class="sticky top-0 z-10 flex items-center bg-[#0C1A18]/80 backdrop-blur-md p-4 pb-3 justify-between border-b border-[#19e5c6]/20 shrink-0">
                <div class="w-12 flex items-center lg:hidden"> 
                  <button id="chat-back-btn" aria-label="Back to chats" class="text-[#19e5c6] p-2 -ml-2">
                    <span class="material-symbols-outlined text-3xl">arrow_back_ios_new</span>
                  </button>
                </div> 
                <h2 id="chat-screen-title" class="text-white text-xl lg:text-2xl font-bold leading-tight tracking-[-0.015em] flex-1 text-center lg:text-left lg:pl-2 truncate px-2">Nova</h2>
                <div class="flex w-auto items-center justify-end space-x-1">
                  <button id="toggle-process-log-btn" aria-label="Toggle Process Log" class="flex items-center justify-center rounded-full h-10 w-10 text-[#19e5c6] hover:bg-[#19e5c6]/10 transition-colors duration-200">
                    <span class="material-symbols-outlined">list_alt</span>
                  </button>
                  <button id="chat-settings-btn" aria-label="Settings" class="flex max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-full h-10 w-10 bg-transparent text-[#19e5c6] hover:bg-[#19e5c6]/10 transition-colors duration-200 lg:hidden">
                      <div class="text-[#19e5c6]" data-icon="Gear" data-size="24px" data-weight="regular">
                      <svg fill="currentColor" height="24px" viewBox="0 0 256 256" width="24px" xmlns="http://www.w3.org/2000/svg">
                          <path d="M128,80a48,48,0,1,0,48,48A48.05,48.05,0,0,0,128,80Zm0,80a32,32,0,1,1,32-32A32,32,0,0,1,128,160Zm88-29.84q.06-2.16,0-4.32l14.92-18.64a8,8,0,0,0,1.48-7.06,107.21,107.21,0,0,0-10.88-26.25,8,8,0,0,0-6-3.93l-23.72-2.64q-1.48-1.56-3-3L186,40.54a8,8,0,0,0-3.94-6,107.71,107.71,0,0,0-26.25-10.87,8,8,0,0,0-7.06,1.49L130.16,40Q128,40,125.84,40L107.2,25.11a8,8,0,0,0-7.06-1.48A107.6,107.6,0,0,0,73.89,34.51a8,8,0,0,0-3.93,6L67.32,64.27q-1.56,1.49-3,3L40.54,70a8,8,0,0,0-6,3.94,107.71,107.71,0,0,0-10.87,26.25,8,8,0,0,0,1.49,7.06L40,125.84Q40,128,40,130.16L25.11,148.8a8,8,0,0,0-1.48,7.06,107.21,107.21,0,0,0,10.88,26.25,8,8,0,0,0,6,3.93l23.72,2.64q1.49,1.56,3,3L70,215.46a8,8,0,0,0,3.94,6,107.71,107.71,0,0,0,26.25,10.87,8,8,0,0,0,7.06-1.49L125.84,216q2.16.06,4.32,0l18.64,14.92a8,8,0,0,0,7.06,1.48,107.21,107.21,0,0,0,26.25-10.88,8,8,0,0,0,3.93-6l2.64-23.72q1.56-1.48,3-3L215.46,186a8,8,0,0,0,6-3.94,107.71,107.71,0,0,0,10.87-26.25,8,8,0,0,0-1.49-7.06Zm-16.1-6.5a73.93,73.93,0,0,1,0,8.68,8,8,0,0,0,1.74,5.48l14.19,17.73a91.57,91.57,0,0,1-6.23,15L187,173.11a8,8,0,0,0-5.1,2.64,74.11,74.11,0,0,1-6.14,6.14,8,8,0,0,0-2.64,5.1l-2.51,22.58a91.32,91.32,0,0,1-15,6.23l-17.74-14.19a8,8,0,0,0-5-1.75h-.48a73.93,73.93,0,0,1-8.68,0,8,8,0,0,0-5.48,1.74L100.45,215.8a91.57,91.57,0,0,1-15-6.23L82.89,187a8,8,0,0,0-2.64-5.1,74.11,74.11,0,0,1-6.14-6.14,8,8,0,0,0-5.1-2.64L46.43,170.6a91.32,91.32,0,0,1-6.23-15l14.19-17.74a8,8,0,0,0,1.74-5.48,73.93,73.93,0,0,1,0-8.68,8,8,0,0,0-1.74-5.48L40.2,100.45a91.57,91.57,0,0,1,6.23-15L69,82.89a8,8,0,0,0,5.1-2.64,74.11,74.11,0,0,1,6.14-6.14A8,8,0,0,0,82.89,69L85.4,46.43a91.32,91.32,0,0,1,15-6.23l17.74,14.19a8,8,0,0,0,5.48,1.74,73.93,73.93,0,0,1,8.68,0,8,8,0,0,0,5.48-1.74L155.55,40.2a91.57,91.57,0,0,1,15,6.23L173.11,69a8,8,0,0,0,2.64,5.1,74.11,74.11,0,0,1,6.14-6.14,8,8,0,0,0,5.1,2.64l22.58,2.51a91.32,91.32,0,0,1,6.23,15l-14.19,17.74A8,8,0,0,0,199.87,123.66Z"></path>
                      </svg>
                      </div>
                  </button>
                  <div class="w-10 lg:flex items-center justify-center hidden"></div>
                </div>
            </div>
            <div id="chat-messages-container" class="flex-grow overflow-y-auto pb-4 flex flex-col px-2 lg:px-4">
            </div>
        </div>
        
        <div class="bg-[#0C1A18]/80 backdrop-blur-md border-t border-[#19e5c6]/20 pt-3 pb-1 shrink-0">
          <div id="nova-processing-indicator" class="text-center text-xs text-[#A0E1D9] py-1 px-4" style="display: none;">Nova is processing...</div>
          <div id="nova-image-processing-indicator" class="text-center text-xs text-[#A0E1D9] py-1 px-4" style="display: none;">Nova is creating an image...</div>
          <div class="flex gap-2.5 px-4 pb-3 overflow-x-auto scrollbar-hide">
            <button class="suggested-prompt-btn flex h-9 shrink-0 items-center justify-center gap-x-2 rounded-full bg-[#1A3A35] hover:bg-[#1F4B44] transition-colors duration-200 px-4 text-sm font-medium text-[#19e5c6] shadow-sm">
              Plan a trip
            </button>
            <button class="suggested-prompt-btn flex h-9 shrink-0 items-center justify-center gap-x-2 rounded-full bg-[#1A3A35] hover:bg-[#1F4B44] transition-colors duration-200 px-4 text-sm font-medium text-[#19e5c6] shadow-sm">
              Summarize this
            </button>
            <button class="suggested-prompt-btn flex h-9 shrink-0 items-center justify-center gap-x-2 rounded-full bg-[#1A3A35] hover:bg-[#1F4B44] transition-colors duration-200 px-4 text-sm font-medium text-[#19e5c6] shadow-sm">
              Translate
            </button>
          </div>
          <div id="staged-file-preview" class="mx-3 mb-2" style="display: none;">
                <div class="flex items-center justify-between bg-[#1A3A35] text-[#A0E1D9] p-2 rounded-md text-xs border border-[#244742]">
                    <div class="flex items-center overflow-hidden">
                        <span class="material-symbols-outlined text-sm mr-2">draft</span>
                        <span class="staged-file-name truncate mr-2">filename.txt</span>
                        <span class="staged-file-type text-[#7A9A94] truncate hidden sm:inline">Type: text</span>
                    </div>
                    <button id="staged-file-clear-button" aria-label="Clear staged file" class="text-red-400 hover:text-red-600 transition-colors">
                        <span class="material-symbols-outlined text-lg">close</span>
                    </button>
                </div>
            </div>
          <div id="chat-input-actions-area" class="flex items-end px-3 py-2 gap-2 @container relative">
            <button id="advanced-options-button" aria-label="Advanced Options" class="order-1 flex items-center justify-center p-3 h-12 w-12 bg-[#1A3A35] text-[#A0E1D9] hover:text-[#19e5c6] rounded-xl shadow-md hover:bg-[#1F4B44] transition-colors duration-200 shrink-0">
                <span class="material-symbols-outlined">tune</span>
            </button>
            <input type="file" id="file-input-hidden" class="hidden" accept=".txt,.pdf,.html,.css,.js,.py,.md,image/*"/>
            
            <!-- Advanced Options Popover -->
            <div id="advanced-options-popover" class="absolute bottom-full left-0 mb-2 w-64 bg-[#0D1A18] border border-[#244742] rounded-lg shadow-xl p-4 space-y-3 z-20" style="display: none;">
                <h4 id="adv-opt-popover-title" class="text-sm font-semibold text-white mb-2">Advanced Options</h4>
                <div class="flex items-center justify-between">
                    <label for="popover-deep-thinking-toggle" class="text-xs text-[#C2E0DB] flex items-center adv-opt-deep-thinking-label">
                        <span class="material-symbols-outlined text-base mr-2">psychology</span>Deep Thinking
                    </label>
                    <input id="popover-deep-thinking-toggle" type="checkbox" class="form-checkbox h-4 w-4 rounded bg-[#244742] border-[#34655e] text-[#19e5c6] focus:ring-[#19e5c6]/50 focus:ring-offset-0">
                </div>
                <div class="flex items-center justify-between">
                    <label for="popover-internet-search-toggle" class="text-xs text-[#C2E0DB] flex items-center adv-opt-internet-search-label">
                        <span class="material-symbols-outlined text-base mr-2">travel_explore</span>Internet Search
                    </label>
                    <input id="popover-internet-search-toggle" type="checkbox" class="form-checkbox h-4 w-4 rounded bg-[#244742] border-[#34655e] text-[#19e5c6] focus:ring-[#19e5c6]/50 focus:ring-offset-0">
                </div>
                 <div class="flex items-center justify-between">
                    <label for="popover-scientific-mode-toggle" class="text-xs text-[#C2E0DB] flex items-center adv-opt-scientific-mode-label">
                       <span class="material-symbols-outlined text-base mr-2">science</span>Scientific Mode
                    </label>
                    <input id="popover-scientific-mode-toggle" type="checkbox" class="form-checkbox h-4 w-4 rounded bg-[#244742] border-[#34655e] text-[#19e5c6] focus:ring-[#19e5c6]/50 focus:ring-offset-0">
                </div>
                <hr class="border-t border-[#244742] my-2">
                <button id="popover-upload-file-button" class="w-full flex items-center justify-center gap-2 text-xs py-2 px-3 rounded-md bg-[#1A3A35] text-[#A0E1D9] hover:text-[#19e5c6] hover:bg-[#1F4B44] transition-colors">
                    <span class="material-symbols-outlined text-base">attach_file</span>
                    <span>Upload File</span>
                </button>
            </div>

            <div class="flex w-full items-stretch rounded-xl bg-[#1A3A35] shadow-md order-2">
              <input id="chat-input" class="order-1 form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-l-xl text-white focus:outline-0 focus:ring-2 focus:ring-[#19e5c6]/50 border-none bg-transparent h-12 placeholder:text-[#A0E1D9]/70 px-4 text-base font-normal leading-normal" placeholder="Ask Nova anything..." value=""/>
              <div class="flex items-center rounded-r-xl order-2"> 
                <button id="voice-mode-toggle" aria-label="Toggle Voice Mode" class="order-1 flex items-center justify-center p-3 text-gray-400 hover:text-[#19e5c6] hover:bg-[#19e5c6]/10 transition-colors duration-200 h-full">
                    <span class="material-symbols-outlined">graphic_eq</span> 
                </button>
                <button id="mic-button" aria-label="Use microphone" class="order-2 mic-button-container relative flex items-center justify-center p-3 text-[#19e5c6] hover:bg-[#19e5c6]/10 transition-colors duration-200 h-full rounded-r-xl">
                    <div class="text-[#19e5c6]" data-icon="Microphone" data-size="24px" data-weight="fill">
                    <svg fill="currentColor" height="24px" viewBox="0 0 256 256" width="24px" xmlns="http://www.w3.org/2000/svg"><path d="M128,176a48.05,48.05,0,0,0,48-48V64a48,48,0,0,0-96,0v64A48.05,48.05,0,0,0,128,176ZM96,64a32,32,0,0,1,64,0v64a32,32,0,0,1-64,0Zm40,143.6V232a8,8,0,0,1-16,0V207.6A80.11,80.11,0,0,1,48,128a8,8,0,0,1,16,0,64,64,0,0,0,128,0,8,8,0,0,1,16,0A80.11,80.11,0,0,1,136,207.6Z"></path></svg>
                    </div>
                    <div class="mic-listening-indicator"></div>
                </button>
              </div>
            </div>
            <button id="send-chat-button" aria-label="Send message" class="order-3 flex items-center justify-center p-3 h-12 w-12 bg-[#19e5c6] text-[#0C1A18] rounded-xl shadow-md hover:bg-[#15c4a9] transition-colors duration-200 shrink-0">
              <svg class="feather feather-arrow-up" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
                <line x1="12" x2="12" y1="19" y2="5"></line>
                <polyline points="5 12 12 5 19 12"></polyline>
              </svg>
            </button>
          </div>
          <div class="h-2 bg-transparent"></div> 
        </div>
      </div>

      <!-- Process Log Panel (Side Panel) -->
      <div id="process-log-panel" class="process-log-panel">
        <div class="process-log-header">
            <h3 class="process-log-title">Process Log</h3>
            <button id="process-log-close-btn" aria-label="Close Process Log">
                <span class="material-symbols-outlined">close</span>
            </button>
        </div>
        <ul id="process-log-list" class="scrollbar-hide"></ul>
      </div>


      <!-- Settings Screen -->
      <div id="settings-screen" class="app-screen bg-[#11221f] justify-between">
        <div class="flex-grow overflow-y-auto px-4 flex flex-col">
          <header class="flex items-center py-4 sticky top-0 bg-[#11221f] z-10 -mx-4 px-4 shrink-0">
            <button id="settings-back-btn" aria-label="Back" class="text-white p-2 -ml-2 lg:hidden"> 
              <span class="material-symbols-outlined text-3xl"> arrow_back_ios_new </span>
            </button>
            <div class="w-10 lg:hidden"></div> 
            <h1 class="text-xl lg:text-2xl font-bold text-white flex-1 text-center lg:text-left lg:pl-2" id="settings-title">Settings</h1>
          </header>
          <main class="flex-grow overflow-y-auto scrollbar-hide lg:py-6">
            <section class="py-4">
              <h2 class="text-lg lg:text-xl font-semibold text-[#e0e0e0] mb-3" id="settings-ai-tone-label">AI Tone</h2>
              <div class="flex flex-col sm:flex-row space-y-3 sm:space-y-0 sm:space-x-3">
                <label class="flex-1 text-sm font-medium leading-normal flex items-center justify-center rounded-lg border border-[#34655e] px-4 py-3 text-white has-[:checked]:border-2 has-[:checked]:border-[#19e5c6] has-[:checked]:bg-[#19e5c6]/10 relative cursor-pointer transition-all duration-200 ease-in-out">
                  <span class="material-symbols-outlined mr-2 text-[#19e5c6] opacity-0 has-[:checked]:opacity-100 transition-opacity"> sentiment_satisfied </span>
                  <span class="settings-tone-friendly-text">Friendly</span>
                  <input id="setting-ai-tone-friendly" class="invisible absolute" name="ai_tone" type="radio" value="friendly"/>
                </label>
                <label class="flex-1 text-sm font-medium leading-normal flex items-center justify-center rounded-lg border border-[#34655e] px-4 py-3 text-white has-[:checked]:border-2 has-[:checked]:border-[#19e5c6] has-[:checked]:bg-[#19e5c6]/10 relative cursor-pointer transition-all duration-200 ease-in-out">
                  <span class="material-symbols-outlined mr-2 text-[#19e5c6] opacity-0 has-[:checked]:opacity-100 transition-opacity"> business_center </span>
                  <span class="settings-tone-formal-text">Formal</span>
                  <input id="setting-ai-tone-formal" class="invisible absolute" name="ai_tone" type="radio" value="formal"/>
                </label>
                <label class="flex-1 text-sm font-medium leading-normal flex items-center justify-center rounded-lg border border-[#34655e] px-4 py-3 text-white has-[:checked]:border-2 has-[:checked]:border-[#19e5c6] has-[:checked]:bg-[#19e5c6]/10 relative cursor-pointer transition-all duration-200 ease-in-out">
                  <span class="material-symbols-outlined mr-2 text-[#19e5c6] opacity-0 has-[:checked]:opacity-100 transition-opacity"> draw </span>
                  <span class="settings-tone-creative-text">Creative</span>
                  <input id="setting-ai-tone-creative" class="invisible absolute" name="ai_tone" type="radio" value="creative"/>
                </label>
              </div>
            </section>

            <section class="py-4">
              <h2 class="text-lg lg:text-xl font-semibold text-[#e0e0e0] mb-3" id="settings-creativity-label">Creativity Level</h2>
              <div class="space-y-2 bg-[#1a322f] p-4 rounded-lg">
                <p class="text-sm text-[#C2E0DB] mb-2" id="settings-creativity-desc">Adjust how factual or inventive Nova's responses are.</p>
                <select id="setting-creativity-level" class="form-select w-full rounded-lg border border-[#244742] bg-[#1A3A35] text-white p-3 focus:ring-2 focus:ring-[#19e5c6] focus:border-[#19e5c6] lg:text-base">
                  <option value="focused" id="settings-creativity-focused">Focused (More Factual)</option>
                  <option value="balanced" selected id="settings-creativity-balanced">Balanced (Default)</option>
                  <option value="inventive" id="settings-creativity-inventive">Inventive (More Creative)</option>
                </select>
              </div>
            </section>

            <section class="py-4 space-y-3">
              <h2 class="text-lg lg:text-xl font-semibold text-[#e0e0e0] mb-3" id="settings-features-label">Features</h2>
               <div class="bg-[#1a322f] p-4 rounded-lg">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center">
                            <span class="material-symbols-outlined text-[#19e5c6] mr-3"> record_voice_over </span>
                            <span class="text-white text-base font-normal" id="settings-tts-label">Voice Output (TTS)</span>
                        </div>
                        <label class="relative inline-flex items-center cursor-pointer">
                            <input id="setting-tts-toggle" type="checkbox" value="" class="sr-only peer" aria-label="Toggle Voice Output">
                            <div class="w-11 h-6 bg-[#34655e] peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-[#19e5c6]"></div>
                        </label>
                    </div>
                </div>
                <div class="bg-[#1a322f] p-4 rounded-lg">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center">
                            <span class="material-symbols-outlined text-[#19e5c6] mr-3">travel_explore</span>
                            <span class="text-white text-base font-normal" id="settings-internet-search-label">Enable Internet Search</span>
                        </div>
                        <label class="relative inline-flex items-center cursor-pointer">
                            <input id="setting-internet-search-toggle" type="checkbox" value="" class="sr-only peer" aria-label="Toggle Internet Search">
                            <div class="w-11 h-6 bg-[#34655e] peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-[#19e5c6]"></div>
                        </label>
                    </div>
                </div>
                <div class="bg-[#1a322f] p-4 rounded-lg">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center">
                            <span class="material-symbols-outlined text-[#19e5c6] mr-3">psychology</span>
                            <span class="text-white text-base font-normal" id="settings-deep-thinking-label">Enable Deep Thinking Mode</span>
                        </div>
                        <label class="relative inline-flex items-center cursor-pointer">
                            <input id="setting-deep-thinking-toggle" type="checkbox" value="" class="sr-only peer" aria-label="Toggle Deep Thinking">
                            <div class="w-11 h-6 bg-[#34655e] peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-[#19e5c6]"></div>
                        </label>
                    </div>
                </div>
                <div class="bg-[#1a322f] p-4 rounded-lg">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center">
                            <span class="material-symbols-outlined text-[#19e5c6] mr-3">science</span>
                            <span class="text-white text-base font-normal" id="settings-scientific-mode-label">Advanced Scientific Research Mode</span>
                        </div>
                        <label class="relative inline-flex items-center cursor-pointer">
                            <input id="setting-advanced-scientific-mode-toggle" type="checkbox" value="" class="sr-only peer" aria-label="Toggle Advanced Scientific Research Mode">
                            <div class="w-11 h-6 bg-[#34655e] peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-[#19e5c6]"></div>
                        </label>
                    </div>
                </div>
            </section>
            <section class="py-4">
              <h2 class="text-lg lg:text-xl font-semibold text-[#e0e0e0] mb-3" id="settings-appearance-label">Appearance</h2>
              <div class="bg-[#1a322f] p-4 rounded-lg">
                <div class="flex items-center justify-between">
                  <div class="flex items-center">
                    <span class="material-symbols-outlined text-[#19e5c6] mr-3"> dark_mode </span>
                    <span class="text-white text-base font-normal" id="settings-dark-mode-label">Dark Mode</span>
                  </div>
                  <label class="relative inline-flex items-center cursor-pointer">
                    <input id="setting-dark-mode-toggle" type="checkbox" value="" class="sr-only peer" aria-label="Toggle Dark Mode">
                    <div class="w-11 h-6 bg-[#34655e] peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-[#19e5c6]"></div>
                  </label>
                </div>
              </div>
            </section>
            <section class="py-4">
                <h2 class="text-lg lg:text-xl font-semibold text-[#e0e0e0] mb-3" id="settings-general-memories-label">General Memories</h2>
                <div class="bg-[#1a322f] p-4 rounded-lg space-y-3">
                    <textarea id="setting-general-memory-input" rows="3" class="form-textarea w-full rounded-lg border border-[#244742] bg-[#1A3A35] text-white p-3 focus:ring-2 focus:ring-[#19e5c6] focus:border-[#19e5c6] placeholder:text-[#7A9A94]" placeholder="Type a general note or memory..."></textarea>
                    <button id="setting-save-general-memory-btn" class="w-full rounded-md bg-[#19e5c6] py-2 px-4 text-[#11221f] text-sm font-semibold hover:bg-opacity-80 transition-colors">Save General Memory</button>
                    <div id="settings-general-memories-list" class="space-y-2 max-h-48 overflow-y-auto scrollbar-hide">
                        <!-- General memories will be listed here -->
                    </div>
                </div>
            </section>
             <section class="py-4">
              <h2 class="text-lg lg:text-xl font-semibold text-[#e0e0e0] mb-3" id="settings-other-label">Other</h2>
              <div class="bg-[#1a322f] p-4 rounded-lg">
                <div class="flex items-center justify-between">
                    <div class="flex items-center">
                        <span class="material-symbols-outlined text-[#19e5c6] mr-3"> translate </span>
                        <span class="text-white text-base font-normal" id="settings-language-label">Language (App UI)</span>
                    </div>
                    <select id="setting-language-select" class="form-select rounded-lg border border-[#244742] bg-[#1A3A35] text-white p-2 text-sm focus:ring-1 focus:ring-[#19e5c6] focus:border-[#19e5c6]">
                        <option value="en">English</option>
                        <option value="ar">العربية (Arabic)</option>
                    </select>
                </div>
              </div>
              <div class="mt-3 bg-[#1a322f] p-4 rounded-lg">
                <div class="flex items-start">
                    <span class="material-symbols-outlined text-[#19e5c6] mr-3 mt-1">badge</span>
                    <div class="text-white text-sm flex-grow">
                        <p class="font-medium" id="settings-dev-info-title">Developer Information</p>
                        <p class="mt-1 text-xs text-[#c2e0db]" id="settings-dev-name">Mohamed Ibrahim Abdullah</p>
                        <p class="mt-1 text-xs text-[#c2e0db]">
                            <span id="settings-dev-contact-label">Contact (WhatsApp & Calls):</span> 
                            <a href="tel:+201128966996" class="text-[#19e5c6] hover:underline">+201128966996</a>
                        </p>
                    </div>
                </div>
              </div>
            </section>
          </main>
        </div>
        <nav class="bottom-nav sticky bottom-0 left-0 right-0 border-t border-[#244742] bg-[#1a322f]/80 backdrop-blur-md shrink-0 lg:hidden">
          <div class="flex justify-around items-center px-2 pt-2 pb-safe-bottom">
            <button data-target="chat-list-screen-home" class="nav-item flex flex-col items-center justify-end gap-1 text-[#93c8c0] hover:text-[#19e5c6] transition-colors p-2 w-1/4"> 
              <span class="material-symbols-outlined">home</span>
              <span class="text-xs nav-text-home">Home</span>
            </button>
            <button data-target="image-studio-screen" class="nav-item flex flex-col items-center justify-end gap-1 text-[#93c8c0] hover:text-[#19e5c6] transition-colors p-2 w-1/4"> 
              <span class="material-symbols-outlined">imagesmode</span>
              <span class="text-xs nav-text-image-studio">Image Studio</span>
            </button>
             <button data-target="profile-screen" class="nav-item flex flex-col items-center justify-end gap-1 text-[#93c8c0] hover:text-[#19e5c6] transition-colors p-2 w-1/4"> 
              <span class="material-symbols-outlined">person</span>
              <span class="text-xs nav-text-profile">Profile</span>
            </button>
            <button data-target="settings-screen" class="nav-item active flex flex-col items-center justify-end gap-1 text-[#19E5C6] p-2 w-1/4"> 
              <span class="material-symbols-outlined filled">settings</span>
              <span class="text-xs font-semibold nav-text-settings">Settings</span>
            </button>
          </div>
          <div class="h-[calc(env(safe-area-inset-bottom)/2)]"></div> 
        </nav>
      </div>

      <!-- Profile Screen -->
      <div id="profile-screen" class="app-screen bg-[#11221f] justify-between">
        <div class="flex-grow overflow-y-auto px-4 flex flex-col">
            <header class="flex items-center py-4 sticky top-0 bg-[#11221f] z-10 -mx-4 px-4 shrink-0 border-b border-[#19e5c6]/20">
                <div class="w-10 lg:hidden"> 
                     <button id="profile-back-btn" aria-label="Back" class="text-white p-2 -ml-2 hidden">
                        <span class="material-symbols-outlined text-3xl"> arrow_back_ios_new </span>
                    </button>
                </div> 
                <h1 class="text-xl lg:text-2xl font-bold text-white flex-1 text-center lg:text-left lg:pl-2" id="profile-title">Profile</h1>
                <div class="w-10"></div> 
            </header>
            <main class="flex-grow flex flex-col items-center text-white p-6 lg:p-8">
                <span class="material-symbols-outlined text-7xl lg:text-8xl text-[#19e5c6] mb-4">account_circle</span>
                <h2 id="profile-user-name" class="text-2xl lg:text-3xl font-bold mb-2">User Name</h2>
                <p id="profile-user-email" class="text-lg text-[#93c8c0] mb-6">user.email@example.com</p>
                
                <div class="w-full max-w-md lg:max-w-lg space-y-4">
                    <div id="profile-user-details" class="bg-[#1a322f] p-4 rounded-lg shadow">
                      <h3 class="font-semibold text-[#19e5c6] mb-2 text-base" id="profile-learned-info-label">Learned Information:</h3>
                      <div class="text-xs lg:text-sm text-gray-300 space-y-1">
                          <p><strong class="text-[#A0E1D9]" id="profile-interests-label">Interests:</strong> <span id="profile-interests">Not yet recorded.</span></p>
                          <p><strong class="text-[#A0E1D9]" id="profile-preferences-label">Preferences:</strong> <span id="profile-preferences">Not yet recorded.</span></p>
                          <p><strong class="text-[#A0E1D9]" id="profile-facts-label">Facts:</strong> <span id="profile-facts">Not yet recorded.</span></p>
                      </div>
                    </div>

                    <button id="view-memories-btn" class="w-full flex items-center justify-between bg-[#1a322f] p-4 rounded-lg hover:bg-[#244742] transition-colors duration-200">
                        <div class="flex items-center">
                            <span class="material-symbols-outlined text-[#19e5c6] mr-3">memory</span>
                            <span class="text-white text-base font-normal" id="profile-view-memories-text">View Saved Memories</span>
                        </div>
                        <span class="material-symbols-outlined text-[#93c8c0]">chevron_right</span>
                    </button>
                </div>

                <button id="logout-button" class="bg-red-500 text-white font-bold py-3 px-6 rounded-full hover:bg-red-600 transition-colors duration-200 mt-8" style="display: none;">
                    Logout
                </button>
            </main>
        </div>
        <nav class="bottom-nav sticky bottom-0 left-0 right-0 border-t border-[#244742] bg-[#1a322f]/80 backdrop-blur-md shrink-0 lg:hidden">
            <div class="flex justify-around items-center px-2 pt-2 pb-safe-bottom">
               <button data-target="chat-list-screen-home" class="nav-item flex flex-col items-center justify-end gap-1 text-[#93c8c0] hover:text-[#19e5c6] transition-colors p-2 w-1/4">
                    <span class="material-symbols-outlined">home</span>
                    <span class="text-xs nav-text-home">Home</span>
                </button>
                <button data-target="image-studio-screen" class="nav-item flex flex-col items-center justify-end gap-1 text-[#93c8c0] hover:text-[#19e5c6] transition-colors p-2 w-1/4">
                    <span class="material-symbols-outlined">imagesmode</span>
                    <span class="text-xs nav-text-image-studio">Image Studio</span>
                </button>
                <button data-target="chat-screen" id="profile-new-chat-nav-btn" class="nav-item flex flex-col items-center justify-end gap-1 text-[#7A9A94] hover:text-[#19E5C6] transition-colors w-1/4 py-1">
                    <svg fill="currentColor" height="26px" viewBox="0 0 256 256" width="26px" xmlns="http://www.w3.org/2000/svg">
                        <path d="M128,32a96,96,0,1,0,96,96A96.11,96.11,0,0,0,128,32Zm0,176a80,80,0,1,1,80-80A80.09,80.09,0,0,1,128,208Zm40-88a8,8,0,0,1-8,8H136v24a8,8,0,0,1-16,0V128H96a8,8,0,0,1,0-16h24V88a8,8,0,0,1,16,0v24h24A8,8,0,0,1,168,120Z" fill-rule="evenodd"></path>
                    </svg>
                    <span class="text-xs nav-text-new-chat">New Chat</span>
                </button>
                <button data-target="profile-screen" class="nav-item active flex flex-col items-center justify-end gap-1 text-[#19E5C6] p-2 w-1/4">
                    <span class="material-symbols-outlined filled">person</span>
                    <span class="text-xs font-semibold nav-text-profile">Profile</span>
                </button>
            </div>
          <div class="h-[calc(env(safe-area-inset-bottom)/2)]"></div>
        </nav>
    </div>

      <!-- In-app Webview Screen -->
      <div id="webview-screen" class="app-screen fixed inset-0 bg-black/70 backdrop-blur-sm z-50 justify-center items-center p-4 lg:p-8">
        <div class="bg-[#0D1A18] w-full h-full lg:max-w-4xl lg:max-h-[80vh] lg:rounded-xl flex flex-col overflow-hidden shadow-2xl border border-[#19e5c6]/30">
            <header class="flex items-center justify-between p-3 border-b border-[#19e5c6]/20 shrink-0">
                <h3 id="webview-title" class="text-sm font-semibold text-white truncate flex-1 pr-2">Loading...</h3>
                <button id="webview-close-btn" aria-label="Close webview" class="text-[#19e5c6] hover:text-opacity-80 p-1 rounded-full hover:bg-[#19e5c6]/10">
                    <span class="material-symbols-outlined text-2xl">close</span>
                </button>
            </header>
            <div id="webview-loading" class="flex-grow flex items-center justify-center text-[#19e5c6]">
                <svg class="animate-spin h-8 w-8 text-[#19e5c6]" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                </svg>
            </div>
            <iframe id="webview-frame" class="w-full flex-grow border-0" style="display: none;"></iframe>
        </div>
      </div>

      <!-- In-app Image Viewer Screen -->
       <div id="image-viewer-screen" class="app-screen fixed inset-0 bg-black/80 backdrop-blur-md z-50 justify-center items-center p-4 lg:p-8">
        <div class="bg-transparent w-full h-full flex flex-col items-center justify-center relative">
            <button id="image-viewer-close-btn" aria-label="Close image viewer" class="absolute top-4 right-4 lg:top-6 lg:right-6 text-white hover:text-opacity-80 p-2 rounded-full bg-black/30 hover:bg-black/50">
                <span class="material-symbols-outlined text-3xl">close</span>
            </button>
            <img id="image-viewer-img" src="" alt="Full screen image" class="max-w-full max-h-full object-contain rounded-lg shadow-2xl lg:max-w-4xl lg:max-h-[85vh]"/>
        </div>
      </div>

      <!-- Code Canvas Screen -->
      <div id="code-canvas-screen" class="app-screen bg-[#0A100F] justify-between">
        <div class="flex-grow overflow-hidden flex flex-col"> 
            <header class="sticky top-0 z-10 flex items-center bg-[#0C1A18]/80 backdrop-blur-md p-4 justify-between border-b border-[#19e5c6]/20 shrink-0">
                <div class="w-12 lg:hidden"></div> 
                <h2 id="code-canvas-title" class="text-white text-xl lg:text-2xl font-bold flex-1 text-center lg:text-left lg:pl-2">Code Canvas</h2>
                <div class="w-12 flex justify-end">
                    <button id="code-canvas-close-btn" aria-label="Close Code Canvas" class="text-[#19e5c6] p-2 -mr-2">
                        <span class="material-symbols-outlined text-3xl">close</span>
                    </button>
                </div>
            </header>
            <div id="code-canvas-main-content" class="flex-grow p-4 flex flex-col overflow-hidden relative"> 
                <div id="code-editor-wrapper" class="flex flex-col min-h-0 h-full relative">
                    <textarea id="code-canvas-textarea" class="w-full flex-grow bg-[#1A3A35] text-white p-3 rounded-lg border border-[#244742] focus:ring-2 focus:ring-[#19e5c6] focus:border-[#19e5c6] font-mono text-sm scrollbar-hide resize-none" placeholder="Enter HTML, CSS, and JS. Preview updates automatically when active."></textarea>
                    <iframe id="code-canvas-inline-preview-iframe" class="w-full h-full bg-white rounded-lg border border-[#244742]" style="display: none;" sandbox="allow-scripts allow-same-origin"></iframe>
                </div>
            </div>
            <footer class="p-3 border-t border-[#19e5c6]/20 shrink-0 bg-[#0C1A18]/80 backdrop-blur-md flex items-center gap-3">
                <button id="code-canvas-toggle-view-btn" class="flex-1 rounded-full bg-[#19e5c6] h-12 text-[#11221f] text-base font-bold hover:bg-opacity-80 transition-colors duration-200">
                    Show Preview
                </button>
                 <button id="code-canvas-enter-fullscreen-btn" aria-label="Enter Fullscreen Preview" class="p-2 rounded-full text-[#A0E1D9] hover:text-[#19e5c6] hover:bg-[#19e5c6]/10 transition-colors duration-200 hidden">
                    <span class="material-symbols-outlined text-2xl">open_in_full</span>
                </button>
                <button id="code-canvas-copy-to-chat-btn" class="flex-1 rounded-full bg-[#1A3A35] h-12 text-[#19e5c6] text-base font-bold hover:bg-[#1F4B44] transition-colors duration-200">
                    Copy to Chat
                </button>
            </footer>
        </div>
      </div>

      <!-- Full Screen Preview Overlay -->
      <div id="full-screen-preview-overlay" class="fixed inset-0 bg-black/90 backdrop-blur-md z-[100] flex flex-col p-4" style="display: none;">
        <header class="flex justify-end mb-2 shrink-0">
            <button id="full-screen-preview-close-btn" aria-label="Close Fullscreen Preview" class="text-white bg-black/30 hover:bg-black/50 rounded-full p-2">
                <span class="material-symbols-outlined text-3xl">close</span>
            </button>
        </header>
        <div class="flex-grow min-h-0">
          <iframe id="full-screen-preview-iframe" class="w-full h-full bg-white rounded-lg border border-gray-600" sandbox="allow-scripts allow-same-origin"></iframe>
        </div>
      </div>

      <!-- Image Studio Screen -->
      <div id="image-studio-screen" class="app-screen bg-[#0D1A18] justify-between">
        <div class="flex-grow flex flex-col overflow-hidden">
            <header class="sticky top-0 z-10 bg-[#0D1A18]/80 backdrop-blur-md shrink-0">
                <div class="flex items-center p-4 pb-3 justify-center lg:justify-start">
                    <h1 id="image-studio-title" class="text-xl lg:text-2xl font-bold text-white tracking-tight lg:pl-2">Image Studio</h1>
                </div>
            </header>
            <main class="flex-grow p-4 flex flex-col gap-4 overflow-y-auto scrollbar-hide">
                <div>
                    <label for="image-studio-prompt-input" class="block text-sm font-medium text-[#A0E1D9] mb-1" id="image-studio-prompt-label">Image Prompt</label>
                    <textarea id="image-studio-prompt-input" rows="3" class="form-textarea w-full rounded-lg border border-[#244742] bg-[#1A3A35] text-white p-3 focus:ring-2 focus:ring-[#19e5c6] focus:border-[#19e5c6] placeholder:text-[#7A9A94] lg:text-base" placeholder="e.g., A majestic lion in a vibrant jungle, hyperrealistic"></textarea>
                </div>
                 <div class="grid grid-cols-1 md:grid-cols-2 gap-4 items-end"> 
                    <div>
                        <label for="image-studio-engine-select" class="block text-sm font-medium text-[#A0E1D9] mb-1" id="image-studio-engine-label">Image Generation Engine</label>
                        <select id="image-studio-engine-select" class="form-select w-full rounded-lg border border-[#244742] bg-[#1A3A35] text-white p-3 focus:ring-2 focus:ring-[#19e5c6] focus:border-[#19e5c6] lg:text-base">
                            <option value="standard" selected>Standard (Free - Imagen 3.0)</option>
                            <option value="imagefx">ImageFX Engine (Premium - Highest Quality)</option>
                        </select>
                    </div>
                    <div>
                        <label for="image-studio-aspect-ratio-select" class="block text-sm font-medium text-[#A0E1D9] mb-1" id="image-studio-aspect-label">Aspect Ratio</label>
                        <select id="image-studio-aspect-ratio-select" class="form-select w-full rounded-lg border border-[#244742] bg-[#1A3A35] text-white p-3 focus:ring-2 focus:ring-[#19e5c6] focus:border-[#19e5c6] lg:text-base">
                            <option value="1:1" selected>1:1 (Square)</option>
                            <option value="16:9">16:9 (Landscape)</option>
                            <option value="9:16">9:16 (Portrait)</option>
                            <option value="4:3">4:3 (Standard)</option>
                            <option value="3:4">3:4 (Tall)</option>
                        </select>
                    </div>
                </div>
                <button id="image-studio-generate-btn" class="w-full lg:max-w-xs lg:self-start rounded-full bg-[#19e5c6] h-12 text-[#11221f] text-base font-bold hover:bg-opacity-80 transition-colors duration-200 flex items-center justify-center gap-2">
                    <span class="material-symbols-outlined">auto_awesome</span>
                    <span id="image-studio-generate-text">Generate Images</span>
                </button>
                <div id="image-studio-loading-indicator" class="text-center py-4 text-[#A0E1D9]" style="display: none;">
                    <div class="flex flex-col items-center justify-center">
                        <svg class="animate-spin h-8 w-8 text-[#19e5c6] mb-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                            <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                        </svg>
                        <span id="image-studio-loading-text">Generating your masterpieces...</span>
                    </div>
                </div>
                <div id="image-studio-error-message" class="text-center py-2 text-red-400" style="display: none;"></div>
                <div id="image-studio-grid" class="grid grid-cols-2 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3">
                </div>
                 <button id="image-studio-download-all-btn" class="w-full mt-2 lg:max-w-xs lg:self-start rounded-full bg-[#1A3A35] h-11 text-[#19e5c6] text-sm font-bold hover:bg-[#1F4B44] transition-colors duration-200 flex items-center justify-center gap-2" style="display: none;">
                    <span class="material-symbols-outlined">download_for_offline</span>
                    <span id="image-studio-download-all-text">Download All Images</span>
                </button>
            </main>
        </div>
        <nav class="bottom-nav sticky bottom-0 bg-[#0D1A18]/80 backdrop-blur-md border-t border-[#1B302C] shrink-0 lg:hidden">
          <div class="flex justify-around items-center px-2 pt-2 pb-safe-bottom">
            <button data-target="chat-list-screen-home" class="nav-item flex flex-col items-center justify-end gap-0.5 text-[#7A9A94] hover:text-[#19E5C6] transition-colors w-1/4 py-1">
                <span class="material-symbols-outlined">home</span>
              <span class="text-xs nav-text-home">Home</span>
            </button>
            <button data-target="image-studio-screen" class="nav-item active flex flex-col items-center justify-end gap-0.5 text-[#19E5C6] transition-colors w-1/4 py-1">
              <span class="material-symbols-outlined filled">imagesmode</span>
              <span class="text-xs font-medium nav-text-image-studio">Image Studio</span>
            </button>
            <button data-target="chat-screen" id="image-studio-new-chat-nav-btn" class="nav-item flex flex-col items-center justify-end gap-0.5 text-[#7A9A94] hover:text-[#19E5C6] transition-colors w-1/4 py-1">
              <svg fill="currentColor" height="26px" viewBox="0 0 256 256" width="26px" xmlns="http://www.w3.org/2000/svg">
                <path d="M128,32a96,96,0,1,0,96,96A96.11,96.11,0,0,0,128,32Zm0,176a80,80,0,1,1,80-80A80.09,80.09,0,0,1,128,208Zm40-88a8,8,0,0,1-8,8H136v24a8,8,0,0,1-16,0V128H96a8,8,0,0,1,0-16h24V88a8,8,0,0,1,16,0v24h24A8,8,0,0,1,168,120Z" fill-rule="evenodd"></path>
              </svg>
              <span class="text-xs nav-text-new-chat">New Chat</span>
            </button>
            <button data-target="profile-screen" class="nav-item flex flex-col items-center justify-end gap-0.5 text-[#7A9A94] hover:text-[#19E5C6] transition-colors w-1/4 py-1">
               <span class="material-symbols-outlined">person</span>
              <span class="text-xs nav-text-profile">Profile</span>
            </button>
          </div>
          <div class="h-[calc(env(safe-area-inset-bottom)/2)]"></div>
        </nav>
      </div>

       <!-- Create Tool Screen -->
      <div id="create-tool-screen" class="app-screen bg-[#0D1A18] justify-between">
        <div class="flex-grow flex flex-col overflow-hidden">
            <header class="sticky top-0 z-10 bg-[#0D1A18]/80 backdrop-blur-md shrink-0">
                <div class="flex items-center p-4 pb-3 justify-between border-b border-[#19e5c6]/20">
                     <button id="create-tool-back-btn" aria-label="Back" class="text-[#19e5c6] p-2 -ml-2 lg:hidden">
                        <span class="material-symbols-outlined text-3xl">arrow_back_ios_new</span>
                    </button>
                    <div class="w-10 lg:hidden"></div>
                    <h1 class="text-xl lg:text-2xl font-bold text-white tracking-tight flex-1 text-center lg:text-left lg:pl-2" id="create-tool-title">Create New Tool</h1>
                    <div class="w-10"></div>
                </div>
            </header>
            <main class="flex-grow p-4 flex flex-col gap-4 overflow-y-auto scrollbar-hide">
                <div>
                    <label for="tool-name-input" class="block text-sm font-medium text-[#A0E1D9] mb-1" id="tool-name-label">Tool Name</label>
                    <input type="text" id="tool-name-input" class="form-input w-full rounded-lg border border-[#244742] bg-[#1A3A35] text-white p-3 focus:ring-2 focus:ring-[#19e5c6] focus:border-[#19e5c6] placeholder:text-[#7A9A94] lg:text-base" placeholder="e.g., Quick Translator, Story Idea Generator"/>
                </div>
                <div>
                    <label for="tool-instructions-input" class="block text-sm font-medium text-[#A0E1D9] mb-1" id="tool-instructions-label">Tool Instructions & Persona (System Prompt)</label>
                    <textarea id="tool-instructions-input" rows="8" class="form-textarea w-full rounded-lg border border-[#244742] bg-[#1A3A35] text-white p-3 focus:ring-2 focus:ring-[#19e5c6] focus:border-[#19e5c6] placeholder:text-[#7A9A94] lg:text-base resize-none" placeholder="Describe what this tool does and how it should behave. E.g., 'You are a helpful assistant that translates text to French. Be concise and accurate.'"></textarea>
                </div>
                 <div>
                    <label for="tool-knowledge-input" class="block text-sm font-medium text-[#A0E1D9] mb-1" id="tool-knowledge-label">Initial Knowledge (Optional)</label>
                    <textarea id="tool-knowledge-input" rows="5" class="form-textarea w-full rounded-lg border border-[#244742] bg-[#1A3A35] text-white p-3 focus:ring-2 focus:ring-[#19e5c6] focus:border-[#19e5c6] placeholder:text-[#7A9A94] lg:text-base resize-none" placeholder="Provide some initial context or data for the tool to use. (e.g., a list of common phrases, a short story template)"></textarea>
                </div>
                <button id="save-tool-button" class="w-full lg:max-w-xs lg:self-start rounded-full bg-[#19e5c6] h-12 text-[#11221f] text-base font-bold hover:bg-opacity-80 transition-colors duration-200 flex items-center justify-center gap-2">
                    <span class="material-symbols-outlined">save</span>
                    <span id="save-tool-text">Save Tool</span>
                </button>
                <p id="create-tool-error-message" class="text-sm text-red-400 text-center mt-2" style="display: none;"></p>
            </main>
        </div>
      </div>

      <!-- Memories Screen -->
      <div id="memories-screen" class="app-screen bg-[#0D1A18] justify-between">
        <div class="flex-grow flex flex-col overflow-hidden">
            <header class="sticky top-0 z-10 bg-[#0D1A18]/80 backdrop-blur-md shrink-0">
                <div class="flex items-center p-4 pb-3 justify-between border-b border-[#19e5c6]/20">
                    <button id="memories-back-btn" aria-label="Back" class="text-[#19e5c6] p-2 -ml-2 lg:hidden">
                        <span class="material-symbols-outlined text-3xl">arrow_back_ios_new</span>
                    </button>
                    <div class="w-10 lg:hidden"></div>
                    <h1 id="memories-title" class="text-xl lg:text-2xl font-bold text-white tracking-tight flex-1 text-center lg:text-left lg:pl-2">Saved Memories</h1>
                    <div class="w-10"></div>
                </div>
            </header>
            <main id="memories-list-container" class="flex-grow p-4 overflow-y-auto scrollbar-hide space-y-3">
                <!-- Saved memories will be populated here -->
            </main>
        </div>
      </div>

    </main>
  </div>

  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-auth-compat.js"></script>
  
  <!-- Libraries for Export Functionality -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js" integrity="sha512-GsLlZN/3F2ErC5SML9iMRCBcmDdDuDenationalizedembedcenter/eKB4q1rMCRjU7HRUOO6n/j+D7t7O7H1hU/BfQJg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js" integrity="sha512-r22gChDnGvBylk90+2e/ycr3RVr/QhJAUeo9LECZGGMV8sGv1vGv401ih3TxdASHpcbNsyJoG0Yv8SjrzJ60ew==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

  <script type="importmap">
{
  "imports": {
    "@google/genai": "https://esm.sh/@google/genai@^0.7.0",
    "path": "https://esm.sh/path@^0.12.7",
    "vite": "https://esm.sh/vite@^6.3.5"
  }
}
</script>
  <script type="module" src="index.js"></script>
</body>
</html>
<link rel="stylesheet" href="index.css">
<script src="index.tsx" type="module"></script>
